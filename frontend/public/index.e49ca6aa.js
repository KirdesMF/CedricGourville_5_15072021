function t(t){return t&&t.__esModule?t.default:t}var n={};function e(t,n,e,a,o,r,c){try{var i=t[r](c),d=i.value}catch(t){return void e(t)}i.done?n(d):Promise.resolve(d).then(a,o)}function a(t){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(t/100)}(n=function(t){return function(){var n=this,a=arguments;return new Promise((function(o,r){var c=t.apply(n,a);function i(t){e(c,o,r,i,d,"next",t)}function d(t){e(c,o,r,i,d,"throw",t)}i(void 0)}))}}).default=n,n.__esModule=!0;var o={teddies:"colors",cameras:"lenses",furniture:"varnish"};function r(t){return parseInt(t,10)}function c(t){return"/"===t?"all":t.split("/")[1]}function i(t){return JSON.parse(localStorage.getItem(t))||[]}var d={clear:function(){localStorage.clear()},addItem:function(t){var{category:n,name:e,quantity:a,option:o}=t,r=i(n),c=r.find((t=>t.name===e&&t.option===o));c||r.push(t),c&&c.quantity<10&&(c.quantity+=a),c&&c.quantity>=10&&(c.quantity=10,alert("10 max bro")),localStorage.setItem(n,JSON.stringify(r))},updateItem:function(t){var{category:n,name:e,quantity:a,option:o}=t,r=i(n);r.find((t=>t.name===e&&t.option===o)).quantity=a,localStorage.setItem(n,JSON.stringify(r))},removeItem:function(t){var{category:n,name:e,option:a}=t,o=i(n),r=o.find((t=>t.name===e&&t.option===a)),c=o.filter((t=>t.name!=r.name||t.option!=r.option));localStorage.setItem(n,JSON.stringify(c))},getProductFromCategory:i,cleanCategory:function(t){localStorage.removeItem(t)}};function s(){return(s=t(n)((function*(t){try{var n=yield fetch("".concat("http://localhost:3000","/api/").concat(t));return n.ok?n.json():void console.log(n.status)}catch(t){console.log(t)}}))).apply(this,arguments)}function u(){return(u=t(n)((function*(t,n){var e="".concat("http://localhost:3000","/api/").concat(t,"/").concat(n);try{var a=yield fetch(e);return a.ok?a.json():void console.log(a.status)}catch(t){console.log(t)}}))).apply(this,arguments)}var l,p={render:(l=t(n)((function*(){var t=window.history.state.category,n=((t,n)=>t.map((t=>{var{_id:e,name:o,price:r,imageUrl:c}=t,i="/".concat(n,"?id=").concat(e);return'\n            <a href="'.concat(i,'" data-router class="article__card">\n               <img width="320" height="240" src="').concat(c,'" />\n               <div>\n                  <h2>').concat(o,"</h2>\n                  <small>").concat(a(r),"</small>\n               </div>\n            </a>\n         ")})).join(""))(yield function(t){return s.apply(this,arguments)}(t),t);return'\n         <section class="article panel h100 grid grid-center">\n            <div class="wrapper grid-flow" id="myContainer">\n               <div>\n                  <h1>'.concat(t,'</h1>\n                  <a href="/" data-router>Back</a>\n               </div>\n               <div class="article__grid">').concat(n,"</div>\n            </div>\n         </section>\n      ")})),function(){return l.apply(this,arguments)})},m=[{path:"/teddies",text:"Teddies",icon:"#teddy-icon"},{path:"/cameras",text:"Cameras",icon:"#camera-icon"},{path:"/furniture",text:"Furnitures",icon:"#furniture-icon"}],h=m.map((t=>'\n      <a href="'.concat(t.path,'" data-router="true">\n         ').concat(t.text,'\n         <span>\n            <svg\n               class="svg-icon"\n               focusable="false"\n               role="img"\n               aria-hidden="true"\n            >\n               <use href="').concat(t.icon,'" />\n            </svg>\n         </span>\n      </a>\n   '))).join(""),y=(m.map((t=>'\n      <a href="'.concat(t.path,'" data-router="true">\n         ').concat(t.text,"\n      </a>\n   "))).join(""),{render:()=>'\n         <section class="home panel h100">\n            <nav class="home__nav wrapper h100">\n               '.concat(h,"\n            </nav>\n         </section>\n      ")}),f={render:function(){var e=t(n)((function*(){var t=window.location.href,n=new URL(t).searchParams.get("id"),e=window.history.state.category,r=function(t){return o[t]}(e),c=yield function(t,n){return u.apply(this,arguments)}(e,n),i=a(c.price),d=c[r].map((t=>'<option value="'.concat(t,'">').concat(t,"</option>")));return'\n         <section class="product panel" >\n            <div class="wrapper">\n               <div class="product__inner" >\n                  <img \n                     src="'.concat(c.imageUrl,'"\n                     alt="').concat(c.description,'"\n                     data-name="').concat(c.name,'"\n                     data-id="').concat(c._id,'" \n                     data-price="').concat(c.price,'"\n                  />\n                  <div class="product__content" >\n                     <h1>').concat(c.name,'</h1>\n                     <a href="/').concat(e,'" data-router>Back</a>\n                     <p>').concat(c.description,"</p>\n                     <b>\n                        ").concat(i,'\n                     </b>\n                     <select data-cart="options" >\n                        ').concat(d,'\n                     </select>\n                     <button data-cart="btn" >Add to cart</button>\n                  </div>\n               </div>\n            </div>\n         </section>\n      ')}));return function(){return e.apply(this,arguments)}}(),set:()=>{var t=document.querySelector('[data-cart="btn"]'),n=document.querySelector('[data-cart="options"]'),e=document.querySelector("[data-id]"),a=window.history.state.category;t.addEventListener("click",(t=>{t.preventDefault();var o={category:a,id:e.dataset.id,name:e.dataset.name,price:e.dataset.price,quantity:1,option:n.value};d.addItem(o)}))}},v=[{type:"text",id:"firstName",label:"First Name"},{type:"text",id:"lastName",label:"Last Name"},{type:"text",id:"address",label:"Address"},{type:"text",id:"city",label:"City"},{type:"text",id:"zip",label:"Zip Code"},{type:"email",id:"email",label:"Email"}],g={render:function(){var e=t(n)((function*(){return'\n         <form action="/success" method="POST"  class="grid-flow form-cart">\n            '.concat(v.map((t=>'\n                  <div>\n                     <label for="'.concat(t.id,'" >').concat(t.label,' *</label>\n                     <input type="').concat(t.type,'" id="').concat(t.id,'" name="').concat(t.id,'" required />\n                  </div>\n               '))).join(""),'\n            <input type="submit" value="Command">\n         </form>\n      ')}));return function(){return e.apply(this,arguments)}}(),set:(t,n)=>{var e=document.querySelector("form"),a=n.map((t=>t.id)),o=n.map((t=>t.quantity*Number(t.price))).reduce(((t,n)=>t+n),0),r=(document.querySelectorAll("form input"),document.getElementById("firstName")),c=document.getElementById("lastName"),i=document.getElementById("email"),s=document.getElementById("city"),u=document.getElementById("address"),l=document.getElementById("zip");e.addEventListener("submit",(n=>{n.preventDefault();var e={contact:{firstName:r.value,lastName:c.value,address:"".concat(u.value," ").concat(l.value),city:s.value,email:i.value},products:a};!function(t,n){fetch("".concat("http://localhost:3000","/api/").concat(t,"/order"),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then((t=>t.json())).then((n=>{sessionStorage.setItem("orderId",n.orderId),d.cleanCategory(t),window.history.pushState({category:t},"","/".concat(t,"/success"));var e=new Event("update");window.dispatchEvent(e)})).catch((t=>alert(t)))}(t,e),sessionStorage.setItem("".concat(t,"-total"),o)}))}},w={render:function(){var e=t(n)((function*(t,n){var e=n.map((t=>t.quantity*Number(t.price))).reduce(((t,n)=>t+n),0),o=n.map((t=>{var n,{quantity:e,price:o,id:r,name:c,option:i,category:d}=t,s=e*Number(o),u="/".concat(d,"?id=").concat(r),l=(n=e,'\n      <select data-cart="select" >\n         '.concat(Array.from({length:10},((t,e)=>"\n               <option ".concat(n===e+1?"selected":"",' value="').concat(e+1,'" >\n                  ').concat(e+1,"\n               </option>\n            "))).join(""),"\n      </select>\n   "));return'\n               <tr data-category="'.concat(d,'" data-id="').concat(r,'" data-name="').concat(c,'" data-option="').concat(i,'" data-quantity="').concat(e,'" >\n                  <td>\n                     <a href="').concat(u,'" data-router >').concat(c,"</a>\n                  </td>\n                  <td>").concat(i,"</td>\n                  <td>").concat(e,"</td>\n                  <td>").concat(a(o),"</td>\n                  <td>").concat(l,"</td>\n                  <td>").concat(a(s),'</td>\n                  <td>\n                     <button data-cart="remove">\n                        <span>\n                           <svg\n                              class="svg-icon"\n                              focusable="false"\n                              role="img"\n                              aria-hidden="true"\n                           >\n                              <use href="#trash-icon" />\n                           </svg>\n                        </span>\n                     </button>\n                  </td>\n               </tr>\n            ')})).join("");if(n.length)return'\n         <table>\n            <thead>\n               <tr>\n                  <th colspan="100">Shopping Cart '.concat(t,"</th>\n               </tr>\n            </thead>\n            <tbody>\n               ").concat(o,'\n            </tbody>\n            <tfoot>\n               <tr>\n                  <th colspan="90">Total</th>\n                  <td>').concat(a(e),"</td>\n               </tr>\n            </tfoot>\n         </table>\n      ")}));return function(t,n){return e.apply(this,arguments)}}(),set:()=>{var t=document.querySelectorAll("tr[data-id]"),n=function(t){t.addEventListener("change",(n=>{if(n.target.matches('[data-cart="select"]')){var e=n.target,a={category:t.dataset.category,id:t.dataset.id,name:t.dataset.name,option:t.dataset.option,quantity:r(e.value)};d.updateItem(a);var o=new Event("update");window.dispatchEvent(o)}})),t.addEventListener("click",(n=>{if(n.target.matches('[data-cart="remove"]')){var e={category:t.dataset.category,id:t.dataset.id,name:t.dataset.name,option:t.dataset.option};d.removeItem(e);var a=new Event("update");window.dispatchEvent(a)}}))};for(var e of t)n(e)}},b=t=>"\n      <div>\n         <h1>YOUR ".concat(t,' CART IS EMPTY</h1>\n         <a data-router href="/').concat("all"===t?"":t,'">Back</a>\n      </div>\n   '),S=function(){var e=t(n)((function*(){var e=Object.keys(localStorage);if(Object.values(localStorage).every((t=>"[]"===t)))return b("all");var a=e.map(function(){var e=t(n)((function*(t){var n=d.getProductFromCategory(t);return w.render(t,n)}));return function(t){return e.apply(this,arguments)}}()),o=yield Promise.all(a);return'\n      <section class="shopping-cart panel h100 grid-flow grid-center">\n         '.concat(o.join(""),"\n      </section>\n   ")}));return function(){return e.apply(this,arguments)}}(),I=[{path:"/",component:y,title:"Oricono - Home"},{path:"/teddies",component:p,title:"Oricono - Teddies"},{path:"/cameras",component:p,title:"Oricono - Cameras"},{path:"/furniture",component:p,title:"Oricono - Furniture"},{path:"/product",component:f,title:"Oricono - Product"},{path:"/shopping-cart",component:{render:function(){var e=t(n)((function*(){var t=window.history.state.category,n=d.getProductFromCategory(t),e=yield w.render(t,n),a=yield g.render();return"all"===t?S():n.length?'\n         <section class="shopping-cart panel h100 grid-flow grid-center">\n            '.concat(e,'\n         </section>\n         <section class="panel">').concat(a,"</section>\n      "):b(t)}));return function(){return e.apply(this,arguments)}}(),set:function(){var t=window.history.state.category,n=d.getProductFromCategory(t);"all"===t&&w.set(),n.length&&(g.set(t,n),w.set())}},title:"Oricono - Shopping Cart "},{path:"/success",component:{render:()=>{var t=history.state.category,n=sessionStorage.getItem("orderId"),e=sessionStorage.getItem("".concat(t,"-total"));return"\n         <section>\n            <h2>MERCI</h2>\n            <p>".concat(n,"</p>\n            <p>").concat(a(e),'</p>\n            <a href="/" data-router="true" >Retour</a>\n         </section>\n      ')}},title:"Orinoco - Success"},{path:"/error",component:{render:()=>'\n         <section class="panel">\n           <div class="wrapper">\n            <a href="/" data-router="true">Error you should go back</a>\n           </div>\n         </section>\n      '},title:"Orinoco - Error"}];function E(){var t=document.querySelector("#shopping-link"),n=history.state.category;document.querySelector('[data-cart="info"]');t.setAttribute("href","/".concat(n,"/shopping-cart"))}function q(){return C.apply(this,arguments)}function C(){return(C=t(n)((function*(){var t=c(window.location.pathname);window.history.pushState({category:t},"")}))).apply(this,arguments)}function O(t){var n=document.getElementById("app"),e=getComputedStyle(n).getPropertyValue("--transition");n.classList.add("transition"),setTimeout((()=>{t(),n.classList.remove("transition")}),r(e))}var N=t=>{t.preventDefault();var n=t.target.getAttribute("href"),e=c(t.target.pathname);location.href!==t.target.href&&O((()=>{window.history.pushState({category:e},"",n),L()}))};function _(){document.querySelectorAll("[data-router]").forEach((t=>{t.hasAttribute("data-event")||(t.addEventListener("click",N),t.setAttribute("data-event","true"))}))}function j(){return P.apply(this,arguments)}function P(){return(P=t(n)((function*(){var t=document.getElementById("app"),n=window.location.pathname,e=window.location.href,{component:a,title:o}=I.find((t=>e.includes("?id=")?"/product"===t.path:n.includes("/shopping-cart")?"/shopping-cart"===t.path:n.includes("/success")?"/success"===t.path:t.path===n||"/error"===t.path));t.innerHTML=yield a.render(),"set"in a&&a.set(),document.title=o}))).apply(this,arguments)}function x(){return(x=t(n)((function*(){yield q(),yield j(),_(),E()}))).apply(this,arguments)}function L(){return k.apply(this,arguments)}function k(){return(k=t(n)((function*(){yield j(),_(),E()}))).apply(this,arguments)}["popstate","update"].forEach((t=>window.addEventListener(t,L))),window.addEventListener("load",(function(){return x.apply(this,arguments)}));
//# sourceMappingURL=index.e49ca6aa.js.map
